{
    "$schema": "./workflows.schema.json",
    "commandMapping": {
        "changelog": {
            "claude": "/changelog-update",
            "copilot": "/changelog-update"
        },
        "code": {
            "claude": "/code",
            "copilot": "/code"
        },
        "code-review": {
            "claude": "/review:codebase",
            "copilot": "/review/codebase"
        },
        "code-simplifier": {
            "claude": "/code-simplifier",
            "copilot": "/code-simplifier"
        },
        "cook": {
            "claude": "/cook",
            "copilot": "/cook"
        },
        "debug": {
            "claude": "/debug",
            "copilot": "/debug"
        },
        "dependency": {
            "claude": "/dependency",
            "copilot": "/team/dependency"
        },
        "design-spec": {
            "claude": "/design-spec",
            "copilot": "/team/design-spec"
        },
        "docs-update": {
            "claude": "/docs:update",
            "copilot": "/docs/update"
        },
        "fix": {
            "claude": "/fix",
            "copilot": "/fix"
        },
        "idea": {
            "claude": "/idea",
            "copilot": "/team/idea"
        },
        "investigate": {
            "claude": "/investigate",
            "copilot": "/investigate"
        },
        "plan": {
            "claude": "/plan",
            "copilot": "/plan"
        },
        "plan-review": {
            "claude": "/plan:review",
            "copilot": "/plan/review"
        },
        "prioritize": {
            "claude": "/prioritize",
            "copilot": "/team/prioritize"
        },
        "quality-gate": {
            "claude": "/quality-gate",
            "copilot": "/team/quality-gate"
        },
        "refine": {
            "claude": "/refine",
            "copilot": "/team/refine"
        },
        "review-changes": {
            "claude": "/review-changes",
            "copilot": "/review-changes"
        },
        "scout": {
            "claude": "/scout",
            "copilot": "/scout"
        },
        "status": {
            "claude": "/status",
            "copilot": "/team/status"
        },
        "story": {
            "claude": "/story",
            "copilot": "/team/story"
        },
        "team-sync": {
            "claude": "/team-sync",
            "copilot": "/team/team-sync"
        },
        "test": {
            "claude": "/test",
            "copilot": "/test"
        },
        "test-cases": {
            "claude": "/test-cases",
            "copilot": "/team/test-cases"
        },
        "test-spec": {
            "claude": "/test-spec",
            "copilot": "/team/test-spec"
        },
        "watzup": {
            "claude": "/watzup",
            "copilot": "/watzup"
        }
    },
    "description": "Workflow automation configuration for Claude Code and GitHub Copilot — AI-native intent detection (v2)",
    "settings": {
        "allowOverride": true,
        "checkpoints": {
            "autoSaveOnCompact": true,
            "enabled": true,
            "filenamePattern": "checkpoint-{YYMMDD}-{HHMM}-{slug}.md",
            "intervalMinutes": 30,
            "path": "plans/reports"
        },
        "confirmHighImpact": true,
        "enabled": true,
        "overridePrefix": "quick:",
        "showDetection": true
    },
    "version": "2.0.0",
    "workflows": {
        "batch-operation": {
            "confirmFirst": true,
            "description": "Multi-file batch operations requiring progress tracking",
            "enableCheckpoints": true,
            "name": "Batch Operation",
            "preActions": {
                "injectContext": "BATCH OPERATION PROTOCOL:\n1. List ALL target files before making changes\n2. Use checkpoints between major batches\n3. Verify each change compiles before proceeding\n4. Stop on first failure — report affected files\n- Guardrail: Never modify files outside stated scope\n- Guardrail: Always provide rollback strategy for batch changes"
            },
            "sequence": ["scout", "plan", "plan-review", "code", "code-review", "test", "watzup"],
            "whenNotToUse": "Single-file changes, test file creation, documentation updates.",
            "whenToUse": "User wants to apply changes across multiple files, directories, or components at once. Includes batch updates, bulk renames, find-and-replace across codebase, or operations targeting 'all' or 'every' instance."
        },
        "bugfix": {
            "confirmFirst": false,
            "description": "Systematic debugging and fix workflow with investigation-first approach",
            "enableCheckpoints": true,
            "name": "Bug Fix",
            "preActions": {
                "injectContext": "BUG FIX PROTOCOL:\n1. Reproduce the issue — identify exact trigger conditions\n2. Trace root cause through code, not symptoms\n3. Verify fix doesn't break related functionality\n4. Add regression test covering the fixed scenario\n5. Update changelog with user-facing description\n- Guardrail: Fix root cause, not symptom\n- Guardrail: Minimal change scope — avoid refactoring during bug fix"
            },
            "sequence": ["scout", "investigate", "debug", "plan", "plan-review", "fix", "code-simplifier", "code-review", "changelog", "test", "watzup"],
            "whenNotToUse": "User wants new features, refactoring, documentation, or investigation without fixing.",
            "whenToUse": "User reports a bug, error, crash, broken functionality, or asks to fix/debug/troubleshoot an issue. Includes regression fixes, 'not working' reports, and exception traces."
        },
        "business-feature-docs": {
            "confirmFirst": false,
            "description": "Business feature documentation with 26-section template enforcement",
            "enableCheckpoints": true,
            "name": "Business Feature Documentation",
            "preActions": {
                "activateSkill": "business-feature-docs",
                "injectContext": "BUSINESS FEATURE DOC REQUIREMENTS:\n- 26 sections mandatory (see template)\n- Quick Navigation with Audience column\n- TC-XX-XXX test case format with GIVEN/WHEN/THEN\n- Evidence field with file:line format\n- Cross-reference parent features if sub-feature",
                "readFiles": ["docs/templates/detailed-feature-docs-template.md"]
            },
            "sequence": ["scout", "investigate", "plan", "plan-review", "docs-update", "test-spec", "test-cases", "watzup"],
            "whenNotToUse": "General documentation updates, code comments, README changes.",
            "whenToUse": "User wants to create or update business feature documentation using the 26-section template. Includes module docs targeting docs/business-features/."
        },
        "deployment": {
            "confirmFirst": true,
            "description": "Deployment and CI/CD pipeline management",
            "enableCheckpoints": true,
            "name": "Deployment & Infrastructure",
            "preActions": {
                "activateSkill": "devops",
                "injectContext": "DEPLOYMENT WORKFLOW:\n1. Review infrastructure requirements\n2. Plan deployment strategy\n3. Implement configuration\n4. Verify deployment"
            },
            "sequence": ["scout", "investigate", "plan", "plan-review", "code", "code-review", "test", "watzup"],
            "whenNotToUse": "Explaining deployment concepts, checking deployment status/history.",
            "whenToUse": "User wants to set up or modify deployment, infrastructure, CI/CD pipelines, Docker configuration, or deploy to environments."
        },
        "design-workflow": {
            "confirmFirst": false,
            "description": "Designer workflow: create design specification from requirements, hand off for review",
            "enableCheckpoints": false,
            "name": "Design Workflow",
            "preActions": {
                "activateSkill": "ui-ux-pro-max",
                "injectContext": "DESIGN WORKFLOW:\n1. Read requirements/PBI\n2. Create design spec with component inventory\n3. Document states, tokens, accessibility\n4. Review with code-review agent",
                "readFiles": ["docs/design-system/FrontendDesignSystem.md"]
            },
            "sequence": ["design-spec", "code-review", "watzup"],
            "whenNotToUse": "Implementing an existing design in code, coding from a spec.",
            "whenToUse": "User wants to create a UI/UX design specification, mockup, wireframe, or component spec from requirements."
        },
        "documentation": {
            "confirmFirst": false,
            "description": "Documentation creation and update workflow",
            "enableCheckpoints": true,
            "name": "Documentation Update",
            "preActions": {
                "injectContext": "DOCUMENTATION PROTOCOL:\n1. Identify all docs affected by recent changes\n2. Verify code examples compile and are accurate\n3. Update cross-references and navigation links\n4. Ensure consistent terminology across docs\n5. Match docs to current codebase state\n- Rules: Evidence-based (cite file:line), no stale content, match existing doc style\n- Output: Updated docs with verified code references"
            },
            "sequence": ["scout", "investigate", "plan", "plan-review", "docs-update", "watzup"],
            "whenNotToUse": "Business feature docs (use business-feature-docs), code implementation, test-only changes.",
            "whenToUse": "User wants to write, update, or improve general documentation, README, or code comments."
        },
        "feature": {
            "confirmFirst": true,
            "description": "Full feature development workflow with planning, implementation, testing, and documentation",
            "enableCheckpoints": true,
            "name": "Feature Implementation",
            "preActions": {
                "injectContext": "FEATURE IMPLEMENTATION PROTOCOL:\n1. Search for existing patterns before creating new code\n2. Follow platform hierarchy: Entity > Service > Component\n3. Place business logic in lowest appropriate layer\n4. Use platform base classes (PlatformComponent, PlatformApiService, PlatformVmStore)\n5. Add changelog entry for user-facing changes\n- Rules: YAGNI (no speculative features), BEM for all UI elements, untilDestroyed() for subscriptions\n- Backend: CQRS Command+Result+Handler in ONE file, DTO owns mapping, side effects in Event Handlers"
            },
            "sequence": ["scout", "plan", "plan-review", "cook", "code-simplifier", "code-review", "changelog", "test", "docs-update", "watzup"],
            "whenNotToUse": "Bug fixes, documentation-only, test-only, migration, refactoring, investigation.",
            "whenToUse": "User wants to implement, add, create, build, or develop a new feature, functionality, module, or component."
        },
        "idea-to-pbi": {
            "confirmFirst": true,
            "description": "PO/BA workflow: capture idea, refine to PBI, create stories, prioritize",
            "enableCheckpoints": true,
            "name": "Idea to PBI",
            "preActions": {
                "activateSkill": "product-owner",
                "injectContext": "IDEA-TO-PBI WORKFLOW:\n1. Capture idea with problem statement\n2. Refine into PBI with acceptance criteria\n3. Break into user stories (GIVEN/WHEN/THEN)\n4. Prioritize using RICE or MoSCoW"
            },
            "sequence": ["idea", "refine", "story", "prioritize", "watzup"],
            "whenNotToUse": "Bug fixes, code implementation, investigation.",
            "whenToUse": "User has a new product idea, feature request, or wants to add to the backlog. Includes refining ideas into PBIs and creating user stories."
        },
        "investigation": {
            "confirmFirst": false,
            "description": "Codebase exploration and understanding workflow",
            "enableCheckpoints": true,
            "name": "Code Investigation",
            "preActions": {
                "injectContext": "INVESTIGATION PROTOCOL:\n- DO NOT modify any files — read-only analysis\n- Trace code paths with evidence (file:line references)\n- Map dependencies and side effects\n- Declare confidence level for findings (<90% = flag uncertainty)\n- Output: Clear explanation with code evidence and dependency map"
            },
            "sequence": ["scout", "investigate"],
            "whenNotToUse": "Any task requiring code changes: implementing, fixing, refactoring, creating, updating, deleting, deploying, or writing documentation.",
            "whenToUse": "User asks how something works, where code is located, wants to understand or explore a codebase feature, trace code paths, or explain implementation details."
        },
        "migration": {
            "confirmFirst": true,
            "description": "Database schema and data migration workflow",
            "enableCheckpoints": true,
            "name": "Database Migration",
            "preActions": {
                "injectContext": "DATABASE MIGRATION PROTOCOL:\n1. Analyze current schema and identify breaking changes\n2. Plan rollback strategy before implementation\n3. Use PlatformDataMigrationExecutor for data migrations\n4. Use EF migrations for schema changes\n5. Verify migration is idempotent (safe to re-run)\n- Guardrail: Always provide rollback path\n- Guardrail: Never delete data without backup strategy"
            },
            "sequence": ["scout", "investigate", "plan", "plan-review", "code", "code-review", "test", "watzup"],
            "whenNotToUse": "Explaining migration concepts, checking migration history/status.",
            "whenToUse": "User wants to create or run database migrations: schema changes, data migrations, EF migrations, adding/removing/altering columns or tables."
        },
        "pbi-to-tests": {
            "confirmFirst": false,
            "description": "QA workflow: generate test spec from PBI, create detailed test cases, run quality gate",
            "enableCheckpoints": true,
            "name": "PBI to Tests",
            "preActions": {
                "activateSkill": "qa-engineer",
                "injectContext": "PBI-TO-TESTS WORKFLOW:\n1. Read PBI acceptance criteria\n2. Generate test specification with TC-{MOD}-{NNN} IDs\n3. Create detailed test cases with evidence\n4. Run pre-QA quality gate"
            },
            "sequence": ["test-spec", "test-cases", "quality-gate", "watzup"],
            "whenNotToUse": "Running existing tests, executing test suites.",
            "whenToUse": "User wants to create or generate test specs/cases from a PBI, feature, or story. Includes QA test generation."
        },
        "performance": {
            "confirmFirst": true,
            "description": "Performance analysis and optimization workflow",
            "enableCheckpoints": true,
            "name": "Performance Optimization",
            "preActions": {
                "activateSkill": "arch-performance-optimization",
                "injectContext": "PERFORMANCE WORKFLOW:\n1. Profile and identify bottlenecks\n2. Analyze root causes\n3. Plan optimization strategy\n4. Implement changes\n5. Verify with benchmarks"
            },
            "sequence": ["scout", "investigate", "plan", "plan-review", "code", "code-review", "test", "watzup"],
            "whenNotToUse": "Explaining performance concepts, checking performance reports/history.",
            "whenToUse": "User wants to analyze or optimize performance: fix slow queries, reduce latency, improve throughput, resolve N+1 problems, address bottlenecks."
        },
        "pm-reporting": {
            "confirmFirst": false,
            "description": "PM workflow: generate status report and dependency analysis",
            "enableCheckpoints": false,
            "name": "PM Reporting",
            "preActions": {
                "activateSkill": "project-manager",
                "injectContext": "PM REPORTING WORKFLOW:\n1. Gather sprint/project data\n2. Generate status report with metrics\n3. Analyze dependencies and blockers\n4. Output to plans/reports/"
            },
            "sequence": ["status", "dependency"],
            "whenNotToUse": "Git status, commit status, PR status, build status, quick one-line status checks.",
            "whenToUse": "User wants a status report, sprint update, project progress report, blocker analysis, or comprehensive project overview."
        },
        "pre-development": {
            "confirmFirst": false,
            "description": "Quality gate and planning before starting development",
            "enableCheckpoints": false,
            "name": "Pre-Development Setup",
            "preActions": {
                "activateSkill": "planning",
                "injectContext": "PRE-DEVELOPMENT WORKFLOW:\n1. Run quality-gate checks (ensure clean slate)\n2. Create implementation plan\n3. Identify dependencies and blockers\n4. Output plan to plans/"
            },
            "sequence": ["quality-gate", "plan"],
            "whenNotToUse": "Already in development, just wanting to explain pre-development concept.",
            "whenToUse": "User wants to prepare before starting development: quality gate checks, setup for new feature work, kick off a new feature, pre-coding preparation."
        },
        "quality-audit": {
            "confirmFirst": true,
            "description": "Quality audit workflow: review code for best practices, plan fixes, implement improvements, verify with tests",
            "enableCheckpoints": true,
            "name": "Quality Audit",
            "preActions": {
                "injectContext": "QUALITY AUDIT PROTOCOL:\n1. Review code against platform patterns and best practices\n2. Identify defects with severity (Critical/Major/Minor)\n3. CRITICAL GATE: Present findings to user BEFORE implementing fixes\n4. Fix only approved items\n5. Verify each fix with tests\n- Rules: Evidence-based findings (file:line), no speculative improvements, fix what's broken not what's different"
            },
            "sequence": ["code-review", "plan", "plan-review", "code", "code-review", "test", "watzup"],
            "whenNotToUse": "Reviewing uncommitted changes (use review-changes), PR review, bug fixes.",
            "whenToUse": "User wants a quality audit: review code for best practices, ensure no flaws, verify quality standards, or audit-and-fix workflow."
        },
        "refactor": {
            "confirmFirst": true,
            "description": "Code improvement and restructuring workflow",
            "enableCheckpoints": true,
            "name": "Code Refactoring",
            "preActions": {
                "injectContext": "REFACTORING PROTOCOL:\n1. Define refactoring scope and expected outcomes\n2. Verify all tests pass BEFORE refactoring\n3. Apply incremental changes — one concern at a time\n4. Verify tests pass AFTER each change\n5. No behavior changes — same inputs produce same outputs\n- Guardrail: Never change behavior during refactoring\n- Guardrail: Follow platform hierarchy (Entity > Service > Component)"
            },
            "sequence": ["scout", "plan", "plan-review", "code", "code-simplifier", "code-review", "test", "watzup"],
            "whenNotToUse": "Bug fixes, new features, quality audits.",
            "whenToUse": "User wants to refactor, restructure, reorganize, clean up code, improve code quality, extract methods, rename, split/merge components, or address technical debt."
        },
        "release-prep": {
            "confirmFirst": true,
            "description": "Quality gate checks and status report before release",
            "enableCheckpoints": true,
            "name": "Release Preparation",
            "preActions": {
                "activateSkill": "project-manager",
                "injectContext": "RELEASE-PREP WORKFLOW:\n1. Run quality-gate checks (tests, lint, build)\n2. Generate status report\n3. Identify blockers before release\n4. Output checklist to plans/reports/"
            },
            "sequence": ["review-changes", "test", "quality-gate", "status"],
            "whenNotToUse": "Git release commands, npm publish, release notes generation, release branch management.",
            "whenToUse": "User wants to prepare for a release: pre-release checks, release readiness, deployment checklist, go-live verification."
        },
        "review": {
            "confirmFirst": false,
            "description": "Code review and quality check workflow",
            "name": "Code Review",
            "preActions": {
                "injectContext": "CODE REVIEW PROTOCOL:\n- Severity levels: CRITICAL (must fix), MAJOR (should fix), MINOR (nice to have), NOTE (informational)\n- Check: Security (OWASP), performance (N+1, memory leaks), correctness, maintainability\n- Verify: Platform patterns compliance, BEM naming, proper base class usage\n- Output: Structured findings with file:line references and suggested fixes"
            },
            "sequence": ["code-review", "watzup"],
            "whenNotToUse": "Reviewing uncommitted/staged changes (use review-changes), reviewing plans/designs/docs, quality audits with fixes.",
            "whenToUse": "User wants a code review, PR review, code quality check, or audit of specific code or changes."
        },
        "review-changes": {
            "confirmFirst": false,
            "description": "Review and verify current uncommitted/staged changes for correctness, best practices, and potential issues",
            "enableCheckpoints": false,
            "name": "Review Current Changes",
            "preActions": {
                "injectContext": "REVIEW CHANGES PROTOCOL:\n1. Identify all uncommitted/staged changes (git diff)\n2. Understand the scope and intent of changes\n3. Review for correctness, best practices, security, and platform compliance\n4. Report findings with severity and file:line references\n- Rules: Evidence-based review, no speculative improvements, structured output"
            },
            "sequence": ["scout", "investigate", "code-review", "watzup"],
            "whenNotToUse": "PR reviews, release prep, quality audits, investigating how code works.",
            "whenToUse": "User wants to review current uncommitted, staged, or recent changes before committing. Includes pre-commit review and 'review all changes'."
        },
        "security-audit": {
            "confirmFirst": false,
            "description": "Security review and vulnerability assessment",
            "enableCheckpoints": true,
            "name": "Security Audit",
            "preActions": {
                "activateSkill": "arch-security-review",
                "injectContext": "SECURITY AUDIT WORKFLOW:\n1. Scan for OWASP Top 10 vulnerabilities\n2. Review authentication and authorization\n3. Check input validation and sanitization\n4. Report findings with severity ratings"
            },
            "sequence": ["scout", "investigate", "watzup"],
            "whenNotToUse": "Implementing new security features, fixing known security bugs.",
            "whenToUse": "User wants a security audit: vulnerability assessment, OWASP check, security review, penetration test analysis."
        },
        "sprint-planning": {
            "confirmFirst": true,
            "description": "Comprehensive sprint planning: prioritize backlog, analyze dependencies, prepare team sync",
            "enableCheckpoints": true,
            "name": "Sprint Planning Session",
            "preActions": {
                "activateSkill": "project-manager",
                "injectContext": "SPRINT-PLANNING WORKFLOW:\n1. Prioritize backlog items by value/effort\n2. Analyze dependencies between items\n3. Prepare team sync agenda\n4. Output sprint plan to team-artifacts/sprints/"
            },
            "sequence": ["prioritize", "dependency", "team-sync"],
            "whenNotToUse": "Sprint review, retrospective, sprint status report, end-of-sprint activities.",
            "whenToUse": "User wants to plan a sprint: prioritize backlog, analyze dependencies, prepare team sync, iteration planning, or sprint kickoff."
        },
        "verification": {
            "confirmFirst": true,
            "description": "Investigation-first verification: understand scope, test/validate, report findings, conditionally plan fix with approval",
            "enableCheckpoints": true,
            "name": "Verification & Validation",
            "preActions": {
                "injectContext": "VERIFICATION PROTOCOL:\n1. Define expected behavior — what 'correct' means\n2. Reproduce the scenario under test\n3. Verify with evidence (test output, logs, code traces)\n4. If issue found: plan fix, get approval, then implement\n5. If no issue: document verification evidence\n- Guardrail: Evidence-based verification — never assume correctness without proof"
            },
            "sequence": ["scout", "investigate", "plan", "plan-review", "fix", "code-review", "test", "watzup"],
            "whenNotToUse": "New feature implementation, code review, documentation, investigation-only, quality audits.",
            "whenToUse": "User wants to verify, validate, confirm, check that something works correctly, or ensure expected behavior. Includes 'make sure' and 'ensure that' requests."
        }
    }
}
