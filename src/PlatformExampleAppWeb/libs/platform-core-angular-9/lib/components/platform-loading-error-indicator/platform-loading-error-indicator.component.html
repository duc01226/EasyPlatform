<!-- Platform Loading Error Indicator Component Template -->
<div
    class="platform-loading-error-indicator"
    [class.--loading]="showLoading$ | async"
    [class.--reloading]="showReloading$ | async"
    [class.--progress-bar]="showProgressBar$ | async"
    [class.--skeleton-loading]="showSkeletonLoading$ | async"
    [class.--error]="showError$ | async"
    [class.--hidden]="isHidden$ | async"
    [class.--progress-bar-absolute-position-mode]="progressBarPositionMode === 'absolute'"
    [class.--custom-loading-template]="hasCustomLoadingContent"
    [class.--custom-reloading-template]="hasCustomReloadingContent"
    [class.--custom-error-template]="hasCustomErrorContent"
    [attr.aria-live]="'polite'"
    [attr.aria-atomic]="true"
>
    <!-- Progress Bar Section (Default for Reloading) -->
    <div
        class="platform-loading-error-indicator__progress-bar-container"
        [class.--absolute-position-mode]="progressBarPositionMode === 'absolute'"
        *ngIf="(showProgressBar$ | async) && !hasCustomReloadingContent"
        role="progressbar"
        aria-label="Reloading"
    >
        <mat-progress-bar mode="indeterminate" class="platform-loading-error-indicator__progress-bar" aria-label="Reloading in progress"> </mat-progress-bar>
    </div>

    <!-- Custom Loading Template Section -->
    <div
        class="platform-loading-error-indicator__loading-custom"
        *ngIf="(showLoading$ | async) && hasCustomLoadingContent"
        role="progressbar"
        aria-label="Loading content"
    >
        <ng-content select="[slot=loading]"></ng-content>
    </div>

    <!-- Skeleton Loading Section (Default for Loading) -->
    <div
        class="platform-loading-error-indicator__skeleton-loading"
        *ngIf="(showSkeletonLoading$ | async) && !hasCustomLoadingContent"
        role="progressbar"
        aria-label="Loading content"
    >
        <!-- Basic skeleton loading UI - can be enhanced with actual skeleton components -->
        <div class="skeleton-placeholder">
            <div class="skeleton-line skeleton-line--title"></div>
            <div class="skeleton-line skeleton-line--text"></div>
            <div class="skeleton-line skeleton-line--text skeleton-line--short"></div>
        </div>
    </div>

    <!-- Custom Reloading Template Section -->
    <div
        class="platform-loading-error-indicator__reloading-custom"
        *ngIf="(showReloading$ | async) && hasCustomReloadingContent"
        role="progressbar"
        aria-label="Reloading content"
    >
        <ng-content select="[slot=reloading]"></ng-content>
    </div>

    <!-- Fallback Custom Loading Template (when reloading but no reloading template) -->
    <div
        class="platform-loading-error-indicator__loading-custom-fallback"
        *ngIf="(showReloading$ | async) && !hasCustomReloadingContent && hasCustomLoadingContent"
        role="progressbar"
        aria-label="Reloading content"
    >
        <ng-content select="[slot=loading]"></ng-content>
    </div>

    <!-- Error State Section -->
    <div class="platform-loading-error-indicator__error" *ngIf="showError$ | async" role="alert" [attr.aria-label]="'Error: ' + (errorMessage$ | async)">
        <!-- Default Error Template -->
        <div class="platform-loading-error-indicator__error-default" *ngIf="!hasCustomErrorContent">
            <div class="platform-loading-error-indicator__error-content">
                <mat-icon class="platform-loading-error-indicator__error-icon" aria-hidden="true">
                    error
                </mat-icon>
                <span class="platform-loading-error-indicator__error-message">
                    {{ errorMessage$ | async }}
                </span>
            </div>

            <div class="platform-loading-error-indicator__error-actions" *ngIf="enableReloadAction || enableDismissAction">
                <button
                    mat-icon-button
                    *ngIf="enableReloadAction"
                    (click)="onReload()"
                    class="platform-loading-error-indicator__action-btn --reload"
                    type="button"
                    [attr.aria-label]="'Retry'"
                    [attr.title]="'Retry'"
                >
                    <mat-icon aria-hidden="true">refresh</mat-icon>
                </button>

                <button
                    mat-icon-button
                    *ngIf="enableDismissAction"
                    (click)="onDismiss()"
                    class="platform-loading-error-indicator__action-btn --dismiss"
                    type="button"
                    [attr.aria-label]="'Dismiss error'"
                    [attr.title]="'Dismiss'"
                >
                    <mat-icon aria-hidden="true">close</mat-icon>
                </button>
            </div>
        </div>

        <!-- Custom Error Template via ng-content -->
        <div class="platform-loading-error-indicator__error-custom" *ngIf="hasCustomErrorContent">
            <ng-content select="[slot=error]"></ng-content>

            <!-- Default actions still available for custom content -->
            <div class="platform-loading-error-indicator__error-actions" *ngIf="(enableReloadAction || enableDismissAction) && !hasCustomActions">
                <button
                    mat-icon-button
                    *ngIf="enableReloadAction"
                    (click)="onReload()"
                    class="platform-loading-error-indicator__action-btn --reload"
                    type="button"
                    [attr.aria-label]="'Retry'"
                    [attr.title]="'Retry'"
                >
                    <mat-icon aria-hidden="true">refresh</mat-icon>
                </button>

                <button
                    mat-icon-button
                    *ngIf="enableDismissAction"
                    (click)="onDismiss()"
                    class="platform-loading-error-indicator__action-btn --dismiss"
                    type="button"
                    [attr.aria-label]="'Dismiss error'"
                    [attr.title]="'Dismiss'"
                >
                    <mat-icon aria-hidden="true">close</mat-icon>
                </button>
            </div>
        </div>
    </div>
</div>
